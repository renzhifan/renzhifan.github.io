(window.webpackJsonp=window.webpackJsonp||[]).push([[176],{590:function(s,t,a){"use strict";a.r(t);var n=a(33),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("Elasticsearch 是一个分布式的搜索和分析引擎，可以用于全文检索、结构化检索和分析，\n并能将这三者结合起来。Elasticsearch 基于 Lucene 开发，是 Lucene 的封装，\n提供了 REST API 的操作接口，开箱即用。\n现在是使用最广的开源搜索引擎之一，Wikipedia、Stack Overflow、GitHub 等都基于 Elasticsearch 来构建他们的搜索引擎。")])]),s._v(" "),a("hr"),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.x/elasticsearch-intro.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),a("OutboundLink")],1),s._v(" "),a("a",{attrs:{href:"https://www.elastic.co/guide/index.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网英文指南"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"_1-elasticsearch-的基础概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-elasticsearch-的基础概念"}},[s._v("#")]),s._v(" 1. Elasticsearch 的基础概念")]),s._v(" "),a("p",[s._v("Elasticsearch 是一个非常灵活和强大的搜索引擎，涉及到非常多的概念，为了降低入门门槛，这里先给大家介绍 Elasticsearch 最最基础的一些概念。")]),s._v(" "),a("p",[s._v("Elasticsearch 本质上是一个数据库，但并不是 MySQL 这种关系型数据库，查询语言也不是 SQL，而是 Elasticsearch 自己的一套查询语言。")]),s._v(" "),a("p",[s._v("既然是数据库，有一些概念是互通的，如下表：\n关系型数据库和ES的类比\n关系数据库 ⇒ 数据库(Database) ⇒ 表(Table) ⇒ 行(Row) ⇒ 列(Column)\nElasticsearch ⇒ 索引(Index) ⇒ 类型(Type) ⇒ 文档(Document) ⇒ 字段(Field)")]),s._v(" "),a("p",[s._v("ES存储中是按照：索引index->类型type->文档document->字段field 级别层次划分的．\nES集群可以包含多个索引，每个索引可以包含多个类型，每个类型可以包含多个文档，每个文档可以包含多个字段")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("MySQL")]),s._v(" "),a("th",[s._v("Elasticsearch")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("表（Table）")]),s._v(" "),a("td",[s._v("索引（Index）")])]),s._v(" "),a("tr",[a("td",[s._v("记录（Row）")]),s._v(" "),a("td",[s._v("文档（Document）")])]),s._v(" "),a("tr",[a("td",[s._v("字段（Column）")]),s._v(" "),a("td",[s._v("字段（Fields）")])])])]),s._v(" "),a("h3",{attrs:{id:"名词解释"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#名词解释"}},[s._v("#")]),s._v(" 名词解释")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("Cluster(集群)")]),s._v("：一个集群就是由一个或者多个"),a("code",[s._v("node")]),s._v("组成在一起，共同工作，共同分享整个数据具有负载均衡的集群")]),s._v(" "),a("li",[a("code",[s._v("Node(节点)")]),s._v("：单个装有Elasticsearch服务并且提供故障转移和扩展的服务器，有一种节点被称为 “协调节点”")]),s._v(" "),a("li",[a("code",[s._v("Index(索引)")]),s._v("：称为索引库，Index相当于关系型数据库的"),a("code",[s._v("Database")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("Type(类型)")]),s._v("：这是索引下的逻辑划分，一般把有共性的文档放到一个类型里面，相当于关系型数据库的"),a("code",[s._v("table")]),s._v("。")]),s._v(" "),a("li",[a("code",[s._v("Document(文档)")]),s._v("：文档，一个文档是一个可以被索引的基础信息单元, "),a("code",[s._v("Json结构")]),s._v("，这点跟"),a("code",[s._v("MongoDB")]),s._v("差不多。"),a("code",[s._v("es是分布式的")]),s._v("，所以一个文档会被分配到不同的节点上，一个文档究竟被分配到哪个分片上是通过这个公式来计算的 "),a("code",[s._v("shard = hash(routing) % number_of_primary_shards")]),s._v("，其中主分片是在创建索引时设置的，"),a("code",[s._v("routing")]),s._v("是一个变量，一般是文档的"),a("code",[s._v("id")]),s._v("，也可以通过api显示指定，通过控制"),a("code",[s._v("routing")]),s._v("的值来控制将文档分配到指定的分片上来")]),s._v(" "),a("li",[a("code",[s._v("Field(字段)")]),s._v("："),a("code",[s._v("Field")]),s._v("是Elasticsearch的最小单位，相当于数据的某一类")]),s._v(" "),a("li",[a("code",[s._v("Mapping(映射)")]),s._v(":用于定义json的结构，类似于关系型数据库中建表时定义的表的结构")]),s._v(" "),a("li",[a("code",[s._v("Shards(分片)")]),s._v("：分片是一个"),a("code",[s._v("功能完整的搜索引擎")]),s._v("，一个分片是一个Lucene的实例。一般是"),a("code",[s._v("应用程序")]),s._v("和"),a("code",[s._v("索引库")]),s._v("进行交互，索引库和"),a("code",[s._v("分片")]),s._v("进行交互，分片分为"),a("code",[s._v("主分片")]),s._v("和"),a("code",[s._v("副本分片")]),s._v("（"),a("em",[s._v("副本分片只是一个主分片的拷贝,副本分片作为硬件故障时保护数据不丢失的冗余备份，并为搜索和返回文档等读操作提供服务")]),s._v("），Elasticsearch将索引分成若干份，每个部分就是一个"),a("code",[s._v("shard")]),s._v("，类似于藏宝图，一张藏宝图撕成多片，所有片拼接起来才是完整的一张图")]),s._v(" "),a("li",[a("code",[s._v("Replicas(复制)")]),s._v("：Replicas是索引一份或者多份的拷贝，为了防止数据的丢失和负载均衡")])]),s._v(" "),a("hr"),s._v(" "),a("ul",[a("li",[s._v("一个集群包含多个节点")]),s._v(" "),a("li",[s._v("一个节点就是一个es实例")]),s._v(" "),a("li",[s._v("一个实例可以有多个分片")]),s._v(" "),a("li",[s._v("一个分片就是一个lucene实例")])]),s._v(" "),a("blockquote",[a("p",[s._v("例如将一篇文档比喻成一张图，将一张图分成4分，允许一份复制，即第三列是第二列的复制")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210301143220.png",alt:""}})]),s._v(" "),a("blockquote",[a("p",[s._v("假如某个数据丢失了，可以使用复制的图片")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210301143252.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"倒排索引-inverted-index"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#倒排索引-inverted-index"}},[s._v("#")]),s._v(" 倒排索引 Inverted index")]),s._v(" "),a("blockquote",[a("p",[s._v("倒排索引被用来存储在全文搜索下某个单词在一个文档或者一组文档中的存储文字的映射")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('# "我爱中国" 分词如下 \ntoken    start_offset  end_offset  type      position\n我           0             1       CN_CHAR       0\n爱           1             2       CN_CHAR       1     \n中国         2             4       CN_WORD       2\n\n# “中国你好”  分词如下\ntoken    start_offset  end_offset  type      position  \n中国         0             2       CN_WORD       0\n你好         2             4       CN_WORD       1\n\n# 分词表\nWordID  分词\n1        我\n2        爱\n3        中国\n4        你好\n\n# 文档表\nDocID    content\n  1      我爱中国\n  2      中国你好\n\n\n#  倒排索引表\n WordID    分词    文档1    文档2\n   1       我       √\n   2       爱       √\n   3       中国     √        √\n   4       你好              √\n\n如果查询”中国“就可以知道，中国在文档1和文档2中出现了，直接返回文档1和文档2中的内容\n\n横向：可以知道每个分词都出现在哪些文档中了\n纵向：每个文档都有哪些分词\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br")])]),a("h2",{attrs:{id:"_2-一些基础操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-一些基础操作"}},[s._v("#")]),s._v(" 2. 一些基础操作")]),s._v(" "),a("h3",{attrs:{id:"创建索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建索引"}},[s._v("#")]),s._v(" 创建索引")]),s._v(" "),a("blockquote",[a("p",[s._v("首先我们创建一个名为 test_index 的索引：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPUT http://localhost:9200/test_index\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("然后查看我们刚刚创建的索引：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://localhost:9200/test_index\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("返回效果如下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_index"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"aliases"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mappings"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"settings"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"index"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"routing"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"allocation"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"include"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_tier_preference"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data_content"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_shards"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"provided_name"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_index"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"creation_date"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1613652554210"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number_of_replicas"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uuid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zZ24dZpLTWOe_V6mRWKs9g"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(":"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"created"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7100199"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("%\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("返回的 JSON 数据都被压缩在一起，看起来很不方便。我们可以在接口中添加了一个参数 "),a("code",[s._v("pretty")]),s._v("，可以让 "),a("code",[s._v("Elasticsearch")]),s._v(" 返回格式化后的 "),a("code",[s._v("JSON")]),s._v(" 字符串：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://localhost:9200/test_index?pretty\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"test_index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"aliases"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"mappings"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"settings"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"index"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"routing"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"allocation"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"include"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"_tier_preference"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"data_content"')]),s._v("\n                        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_shards"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"provided_name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_index"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"creation_date"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1613652554210"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_replicas"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"uuid"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zZ24dZpLTWOe_V6mRWKs9g"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"version"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"created"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7100199"')]),s._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("h3",{attrs:{id:"创建类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建类型"}},[s._v("#")]),s._v(" 创建类型")]),s._v(" "),a("p",[s._v("接下来我们将在刚刚创建的索引中创建一个新的类型，对应的接口地址是 "),a("code",[s._v("/{index_name}/_mapping")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_mapping?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n  "properties": {\n    "title": { "type": "text", "analyzer": "ik_smart" }, \n    "description": { "type": "text", "analyzer": "ik_smart" },\n    "price": { "type": "scaled_float", "scaling_factor": 100 }\n  }\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("解析：")]),s._v(" "),a("ul",[a("li",[s._v("提交数据中的 "),a("code",[s._v("properties")]),s._v(" 代表这个索引中各个字段的定义，其中 "),a("code",[s._v("key")]),s._v(" 为字段名称，"),a("code",[s._v("value")]),s._v(" 是字段的类型定义；")]),s._v(" "),a("li",[a("code",[s._v("type")]),s._v(" 定义了字段的数据类型，常用的有 "),a("code",[s._v("text / integer / date / boolean")]),s._v("，当然还有许多类型，不一一列出。")]),s._v(" "),a("li",[a("code",[s._v("analyzer")]),s._v(" 是一个新的概念，这是告诉 "),a("code",[s._v("Elasticsearch")]),s._v(" 应该用什么方式去给这个字段做分词，这里我们用了 "),a("code",[s._v("ik_smart")]),s._v("，是一个中文分词器，后面会有介绍。")])]),s._v(" "),a("p",[s._v("上面的命令返回结果如下")]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"acknowledged"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("blockquote",[a("p",[s._v("在 Elasticsearch 的返回中如果包含了 "),a("code",[s._v('"acknowledged" : true')]),s._v(", 则代表请求成功。")])]),s._v(" "),a("h3",{attrs:{id:"创建文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建文档"}},[s._v("#")]),s._v(" 创建文档")]),s._v(" "),a("p",[s._v("接下来我们要往索引里面插入一些文档：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_doc/1?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n    "title": "iPhone X",\n    "description": "新品到货",\n    "price": 8848\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_doc/2?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n    "title": "OPPO R15",\n    "description": "新品到货",\n    "price": 2000\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_doc/3?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n    "title": "宝马",\n    "description": "我的宝马多少马力",\n    "price": 8848\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_doc/4?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n    "title": "保时捷",\n    "description": "我的保时捷马力不错",\n    "price": 8848\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" -XPUT http://localhost:9200/test_index/_doc/5?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{\n    "title": "宝马",\n    "description": "我的宝马多少马力呀",\n    "price": 8848\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("URL 中的 "),a("code",[s._v("1")]),s._v("、"),a("code",[s._v("2")]),s._v("、"),a("code",[s._v("3")]),s._v("、"),a("code",[s._v("4")]),s._v("、"),a("code",[s._v("5")]),s._v(" 是文档的 ID，这点和 Mysql 不太一样，Elasticsearch 的文档 ID 不是自增的，需要我们手动指定。")]),s._v(" "),a("p",[s._v("上面的命令执行后返回如下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_index"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test_index"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_doc"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_version"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"result"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"created"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_shards"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"total"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"successful"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"failed"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_seq_no"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"_primary_term"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br")])]),a("h3",{attrs:{id:"读取文档数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#读取文档数据"}},[s._v("#")]),s._v(" 读取文档数据")]),s._v(" "),a("p",[s._v("接下来我们用 ID 来获取指定的文档：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" http://localhost:9200/test_index/_doc/1?pretty\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("返回如下\n"),a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219151033.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"简单搜索"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单搜索"}},[s._v("#")]),s._v(" 简单搜索")]),s._v(" "),a("p",[s._v("接下来我们来试试 Elasticsearch 的搜索功能：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n    "query" : { "match" : { "description" : "新" }}\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("这个查询是搜索 "),a("code",[s._v("description")]),s._v(" 中包含 "),a("code",[s._v("新")]),s._v(" 的文档，返回如下：")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219151227.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219151806.png",alt:""}}),s._v("\n结果是空，再试试"),a("code",[s._v("『新品』")]),s._v("这个关键词：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n    "query" : { "match" : { "description" : "新品" }}\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("返回如下\n"),a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219151459.png",alt:""}}),s._v(" "),a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219151901.png",alt:""}}),s._v("\n有数据了，这是 "),a("code",[s._v("ik_smart")]),s._v(" 分词器的作用，"),a("code",[s._v("ik_smart")]),s._v(" 会把『新品到货』分词成『新品』和『到货』两个词，当我们用 "),a("code",[s._v("match")]),s._v(" 来搜索时，Elasticsearch 就会拿搜索词在分词结果中寻找完全匹配的文档。因此我们用『新』来搜索时返回的是空，而『新品』则有数据")]),s._v(" "),a("blockquote",[a("p",[s._v("从上面的数据返回可以看到时返回了全部的两条数据")])]),s._v(" "),a("p",[s._v("Elastic 默认一次返回10条结果，可以通过"),a("code",[s._v("size")]),s._v("字段改变这个设置。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n  "query": {\n    "match": {\n      "description": "新品"\n    }\n  },\n  "size": 1\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("上面代码指定，每次只返回一条结果\n"),a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219154527.png",alt:""}})]),s._v(" "),a("p",[s._v("还可以通过"),a("code",[s._v("from")]),s._v("字段，指定位移。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n  "query": {\n    "match": {\n      "description": "新品"\n    }\n  },\n  "from": 1,\n  "size": 1\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("blockquote",[a("p",[s._v("上面代码指定，从位置1开始（"),a("code",[s._v("默认是从位置0开始")]),s._v("），只返回一条结果。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219155155.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"逻辑运算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#逻辑运算"}},[s._v("#")]),s._v(" 逻辑运算")]),s._v(" "),a("p",[s._v("如果有多个搜索关键字， Elastic 认为它们是"),a("code",[s._v("or")]),s._v("关系。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n  "query": {\n    "match": {\n      "description": "新品 保时捷"\n    }\n  }\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219155904.png",alt:""}})]),s._v(" "),a("p",[s._v("如果要执行多个关键词的"),a("code",[s._v("and")]),s._v("搜索，必须使用"),a("a",{attrs:{href:"https://www.elastic.co/guide/en/elasticsearch/reference/7.x/query-dsl-bool-query.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("布尔查询"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -XPOST -H"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type:application/json'")]),s._v(" http://localhost:9200/test_index/_doc/_search?pretty -d"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'\n{\n  "query": {\n    "bool": {\n      "must": [\n        {\n          "match": {\n            "description": "马力"\n          }\n        },\n        {\n          "match": {\n            "description": "保时捷"\n          }\n        }\n      ]\n    }\n  }\n}\'')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br")])]),a("p",[a("img",{attrs:{src:"https://raw.githubusercontent.com/renzhifan/image/master/img/20210219160157.png",alt:""}})])])}),[],!1,null,null,null);t.default=e.exports}}]);