(window.webpackJsonp=window.webpackJsonp||[]).push([[213],{627:function(s,a,n){"use strict";n.r(a);var t=n(33),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("blockquote",[n("p",[s._v("RabbitMQ的消息过期时间（TTL）下面两种方式进行设置")])]),s._v(" "),n("ul",[n("li",[s._v("通过队列属性设置，队列中所有消息都有相同的过期时间。")]),s._v(" "),n("li",[s._v("对每条消息单独设置过期时间，每条消息的TTL可以不同。如果两种方法一起使用，则消息的TTL以两者之间较小的那个数值为准。")])]),s._v(" "),n("blockquote",[n("p",[s._v("提示：对于第一种设置队列属性的方法，一旦消息过期，就会从队列中抹去，而在第二种方法中，即使消息过期，也不会马上从队列中删除，因为每条消息是否过期是在消息投递到消费者之前才进行检查。")])]),s._v(" "),n("h2",{attrs:{id:"设置队列ttl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置队列ttl"}},[s._v("#")]),s._v(" 设置队列TTL")]),s._v(" "),n("p",[s._v("通过队列属性(x-message-ttl)设置消息过期时间。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v(' // 队列属性\n    props := make(map[string]interface{})\n    // 消息过期时间为60秒\n    props["x-message-ttl"] = 60000\n\n    q, err := ch.QueueDeclare(\n        "ttl.hello", // 队列名\n        true,   // 是否持久化队列\n        false,\n        false,\n        false,\n        props, // 设置队列属性\n    )\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h2",{attrs:{id:"设置消息ttl"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#设置消息ttl"}},[s._v("#")]),s._v(" 设置消息TTL")]),s._v(" "),n("p",[s._v("通过消息属性设置消息过期时间")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('err = ch.Publish(\n            "exchange",     // 交换机名\n            "", // 路由参数\n            false,\n            false,\n            amqp.Publishing{\n                Expiration: "30000", // 过期时间为30秒\n                ContentType: "text/plain",\n                Body:        []byte(body),\n            })\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);