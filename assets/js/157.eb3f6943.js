(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{571:function(s,t,a){"use strict";a.r(t);var e=a(33),r=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"_1-in和not-in子查询优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-in和not-in子查询优化"}},[s._v("#")]),s._v(" 1.in和not in子查询优化")]),s._v(" "),a("p",[a("code",[s._v("not in")]),s._v(" 是不能命中索引的，所以以下子查询性能很低。")]),s._v(" "),a("p",[s._v("如果是确定且有限的集合时，可以使用。如 "),a("code",[s._v("IN （0，1，2）")]),s._v("。")]),s._v(" "),a("p",[s._v("用 "),a("code",[s._v("exists")]),s._v("或 "),a("code",[s._v("notexists")]),s._v("代替")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test2  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" id1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" test1  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXISTS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test2  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" id1 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("blockquote",[a("p",[s._v("尽量用join代替")])]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INNER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" test2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" id2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" id1 \n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" test1 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LEFT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" test2 "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" id2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" id1  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" id2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"_2-模式匹配like-xxx-优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-模式匹配like-xxx-优化"}},[s._v("#")]),s._v(" 2.模式匹配like '%xxx%'优化")]),s._v(" "),a("p",[a("code",[s._v("like 'xxx%")]),s._v("可以用到索引，但是"),a("code",[s._v("like '%xxx%")]),s._v("却无法用到索引。")]),s._v(" "),a("h2",{attrs:{id:"_3-大表高效取分页数据"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-大表高效取分页数据"}},[s._v("#")]),s._v(" 3.大表高效取分页数据")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cbbd a "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INNER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("JOIN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" cbbd  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("800000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" b "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("id\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_4-count-统计函数如何加快速度"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-count-统计函数如何加快速度"}},[s._v("#")]),s._v(" 4.COUNT(*)统计函数如何加快速度")]),s._v(" "),a("p",[s._v("在"),a("code",[s._v("mysql 5.7")]),s._v("中，对于"),a("code",[s._v("select count(*) from table")]),s._v(" 的优化，可以设置为")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" uid"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("其中uid为辅助索引，辅助索引不存放数据，而是有一个指针指向对应的数据块，因此速度更快；")]),s._v(" "),a("p",[s._v("从实际业务角度优化：既然我们知道innodb引擎并不适合做 "),a("code",[s._v("select count(*)")]),s._v("查询，那么我们回过头来看看实际业务的需求是怎样的？")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("count")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" cbbd\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("采用这样的查询是因为需要查出实时参与活动的总人数，但是这里的“实时”是否一定要实时，采用准实时，用户会反感吗？或者即使有一定的偏差，普通用户能感知吗？如果我们得出答案，这个实时的参与数只要准实时，允许一定的偏差，那么就好办了：")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v("  cbbd  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("order")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" id "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("desc")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("limit")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("我们只要查最新的一条记录，id是自增字段，取当前的这个id值就可以大约知道总参与人数了（注意我们的项目里并不会删除参与记录）。")]),s._v(" "),a("h2",{attrs:{id:"_5-or条件优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-or条件优化"}},[s._v("#")]),s._v(" 5.or条件优化")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" aladdin_resource "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("OR")]),s._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("解决办法就是用"),a("code",[s._v("union")]),s._v("替换"),a("code",[s._v("or")])]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" aladdin_resource "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("union")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("select")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" aladdin_resource "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" state"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_6-on-duplicate-key-update"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-on-duplicate-key-update"}},[s._v("#")]),s._v(" 6.ON DUPLICATE KEY UPDATE")]),s._v(" "),a("p",[a("code",[s._v("mysql")]),s._v("中高效的主键冲突处理，冲突则执行"),a("code",[s._v("update")]),s._v("，不冲突则执行"),a("code",[s._v("insert")])]),s._v(" "),a("blockquote",[a("p",[s._v("注意："),a("code",[s._v("ON DUPLICATE KEY UPDATE")]),s._v("只是"),a("code",[s._v("MySQL")]),s._v("的特有语法，并不是SQL标准语法！")])]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("IF")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" ipstats "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" ipstats "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SET")]),s._v(" clicks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("clicks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" ip"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n} "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("else")]),s._v(" {\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" ipstats "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" clicks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n}\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("以上几行代码可以用以下一行代码取代")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INSERT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INTO")]),s._v(" ipstats "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("VALUES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'192.168.0.1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DUPLICATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("KEY")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("UPDATE")]),s._v(" clicks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("clicks"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"_7-去掉不必要的降序可以提升性能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-去掉不必要的降序可以提升性能"}},[s._v("#")]),s._v(" 7.去掉不必要的降序可以提升性能")]),s._v(" "),a("blockquote",[a("p",[s._v("因为索引排序默认按照升序 ，如果改用desc变成降序，导致与索引的排序方式不同，从而产生"),a("code",[s._v("Using filesort")]),s._v("，导致效率低下")])]),s._v(" "),a("h2",{attrs:{id:"_8-用where子句替换having子句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-用where子句替换having子句"}},[s._v("#")]),s._v(" 8.用where子句替换having子句")]),s._v(" "),a("h2",{attrs:{id:"_9-合理使用索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9-合理使用索引"}},[s._v("#")]),s._v(" 9.合理使用索引")]),s._v(" "),a("p",[s._v("合理使用单列所引和联合索引")]),s._v(" "),a("p",[s._v("字段使用函数将不能使用索引")]),s._v(" "),a("h2",{attrs:{id:"_10-致命的无引号导致全表扫描-无法用到索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10-致命的无引号导致全表扫描-无法用到索引"}},[s._v("#")]),s._v(" 10.致命的无引号导致全表扫描，无法用到索引")]),s._v(" "),a("h2",{attrs:{id:"_11-优化器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_11-优化器"}},[s._v("#")]),s._v(" 11.优化器")]),s._v(" "),a("blockquote",[a("p",[s._v("当取出的数据量超过表中数据的20%，优化器就不会使用索引，而是全表扫描")])]),s._v(" "),a("h2",{attrs:{id:"_12-考虑不为某些列建立索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_12-考虑不为某些列建立索引"}},[s._v("#")]),s._v(" 12.考虑不为某些列建立索引")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("对于那些在查询中很少使用或者参考的列不应该创建索引")])])]),s._v(" "),a("blockquote",[a("p",[s._v("原因：既然这些列很少使用到，因此有索引或者无索引，并不能提高查询速度。相反，由于增加了索引，反而降低了系统的维护速度和增大了空间需求")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("对于那些只有很少数据值的列也不应该增加索引")])])]),s._v(" "),a("blockquote",[a("p",[s._v("原因：由于这些列的取值很少，例如人事表的性别列，在查询的结果中，结果集的数据行占了表中数据行的很大比 例，即需要在表中搜索的数据行的比例很大。增加索引，并不能明显加快检索速度")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("对于那些定义为text, image和bit数据类型的列不应该增加索引")])])]),s._v(" "),a("blockquote",[a("p",[s._v("原因：这些列的数据量要么相当大，要么取值很少")])]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("当修改性能远远大于检索性能时，不应该创建索")])])]),s._v(" "),a("blockquote",[a("p",[s._v("原因：修改性能和检索性能是互相矛盾的。当增加索引时，会提高检索性能，但是会降低修改性能。当减少索引时，会提高修改性能，降低检索性能。因此，当修改性能远远大于检索性能时，不应该创建索引")])]),s._v(" "),a("h2",{attrs:{id:"_13-order-by-、group-by-优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_13-order-by-、group-by-优化"}},[s._v("#")]),s._v(" 13.order by 、group by 优化")])])}),[],!1,null,null,null);t.default=r.exports}}]);