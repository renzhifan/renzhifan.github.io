(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{575:function(t,a,s){"use strict";s.r(a);var e=s(33),n=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_1、定义"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、定义"}},[t._v("#")]),t._v(" 1、定义")]),t._v(" "),s("ul",[s("li",[t._v("关键词：Transaction")]),t._v(" "),s("li",[t._v("一个最小的不可再分的工作单元")]),t._v(" "),s("li",[t._v("通常一个事务对应一个完整的业务")]),t._v(" "),s("li",[t._v("在 MySQL 中只有使用了 Innodb 数据库引擎的数据库或表才支持事务")]),t._v(" "),s("li",[t._v("用来维护数据库的完整性，保证成批的 SQL语句要么全部执行，要么全部不执行")]),t._v(" "),s("li",[t._v("用来管理DML(insert、update、delete)语句")]),t._v(" "),s("li",[t._v("用于处理操作量大，复杂度高的数据")])]),t._v(" "),s("h2",{attrs:{id:"_2、四大特征-acid"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、四大特征-acid"}},[t._v("#")]),t._v(" 2、四大特征（ACID）")]),t._v(" "),s("ul",[s("li",[t._v("原子性(A)：事务是最小单元，不可再分")]),t._v(" "),s("li",[t._v("一致性(C)：事务要求所有的DML语句操作的时候，必须保证同时成功或者同时失败")]),t._v(" "),s("li",[t._v("隔离性(I)：事务A和事务B之间具有隔离性")]),t._v(" "),s("li",[t._v("持久性(D)：是事务的保证，事务终结的标志(内存的数据持久到硬盘文件中)")])]),t._v(" "),s("h2",{attrs:{id:"_3、事务控制语句"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、事务控制语句"}},[t._v("#")]),t._v(" 3、事务控制语句")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("// 开始事务\nbegin\nstart transaction\n\n// 提交事务\ncommit\n\n// 回滚事务\nrollback\n\n// 设置事务隔离级别\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" transaction\n\n// 设置提交模式\n// 禁止自动提交\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" autocommit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n// 开启自动提交\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" autocommit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("blockquote",[s("p",[t._v("注意：在 MySQL 命令行的默认设置下，事务都是自动提交的，即执行 SQL 语句后就会马上执行 COMMIT 操作。")])]),t._v(" "),s("h2",{attrs:{id:"_4、事务隔离级别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4、事务隔离级别"}},[t._v("#")]),t._v(" 4、事务隔离级别")]),t._v(" "),s("h3",{attrs:{id:"_1-读未提交-read-uncommitted"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-读未提交-read-uncommitted"}},[t._v("#")]),t._v(" （1）读未提交：read uncommitted")]),t._v(" "),s("ul",[s("li",[t._v("事物A和事物B，事物A未提交的数据，事物B可以读取到")]),t._v(" "),s("li",[t._v("这里读取到的数据叫做“脏数据”")]),t._v(" "),s("li",[t._v("这种隔离级别最低，这种级别一般是在理论上存在，数据库隔离级别一般都高于该级别")])]),t._v(" "),s("h3",{attrs:{id:"_2-读已提交-read-commited"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-读已提交-read-commited"}},[t._v("#")]),t._v(" （2）读已提交：read commited")]),t._v(" "),s("ul",[s("li",[t._v("事物A和事物B，事物A提交的数据，事物B才能读取到")]),t._v(" "),s("li",[t._v("这种隔离级别高于读未提交")]),t._v(" "),s("li",[t._v("换句话说，对方事物提交之后的数据，我当前事物才能读取到")]),t._v(" "),s("li",[t._v("这种级别可以避免“脏数据”")]),t._v(" "),s("li",[t._v("这种隔离级别会导致“不可重复读取”")]),t._v(" "),s("li",[t._v("Oracle默认隔离级别")])]),t._v(" "),s("h3",{attrs:{id:"_3-可重复读-repeatable-read"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-可重复读-repeatable-read"}},[t._v("#")]),t._v(" （3）可重复读：repeatable read")]),t._v(" "),s("ul",[s("li",[t._v("事务A和事务B，事务A提交之后的数据，事务B读取不到")]),t._v(" "),s("li",[t._v("事务B是可重复读取数据")]),t._v(" "),s("li",[t._v("这种隔离级别高于读已提交")]),t._v(" "),s("li",[t._v("换句话说，对方提交之后的数据，我还是读取不到")]),t._v(" "),s("li",[t._v("这种隔离级别可以避免“不可重复读取”，达到可重复读取")]),t._v(" "),s("li",[t._v("比如1点和2点读到数据是同一个")]),t._v(" "),s("li",[t._v("MySQL默认级别")]),t._v(" "),s("li",[t._v("虽然可以达到可重复读取，但是会导致“幻像读”")])]),t._v(" "),s("h3",{attrs:{id:"_4-串行化-serializable"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-串行化-serializable"}},[t._v("#")]),t._v(" （4）串行化：serializable")]),t._v(" "),s("ul",[s("li",[t._v("事务A和事务B，事务A在操作数据库时，事务B只能排队等待")]),t._v(" "),s("li",[t._v("这种隔离级别很少使用，吞吐量太低，用户体验差")]),t._v(" "),s("li",[t._v("这种级别可以避免“幻像读”，每一次读取的都是数据库中真实存在数据，事务A与事务B串行，而不并发")])]),t._v(" "),s("h2",{attrs:{id:"_5、隔离级别与一致性关系"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5、隔离级别与一致性关系"}},[t._v("#")]),t._v(" 5、隔离级别与一致性关系")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("隔离级别")]),t._v(" "),s("th",{staticStyle:{"text-align":"center"}},[t._v("脏读取")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("不可重复读")]),t._v(" "),s("th",{staticStyle:{"text-align":"right"}},[t._v("幻象读")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("读未提交")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("可能")])]),t._v(" "),s("tr",[s("td",[t._v("读已提交")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("可能")])]),t._v(" "),s("tr",[s("td",[t._v("可重复读")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("不可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("对InnoDB 不可能")])]),t._v(" "),s("tr",[s("td",[t._v("串行化")]),t._v(" "),s("td",{staticStyle:{"text-align":"center"}},[t._v("不可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("不可能")]),t._v(" "),s("td",{staticStyle:{"text-align":"right"}},[t._v("不可能")])])])]),t._v(" "),s("h2",{attrs:{id:"_6、查看事务隔离级别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6、查看事务隔离级别"}},[t._v("#")]),t._v(" 6、查看事务隔离级别")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("// 查看当前会话事务隔离级别\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" @@tx_isolation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nshow variables like "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tx_isolation'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 查看系统当前隔离级别\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" @@global.tx_isolation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nshow global variables like "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'tx_isolation'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("h2",{attrs:{id:"_7、设置事务隔离级别"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7、设置事务隔离级别"}},[t._v("#")]),t._v(" 7、设置事务隔离级别")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("// 设置当前会话隔离级别\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" session transaction isolatin level repeatable "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n// 设置系统当前隔离级别\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("set")]),t._v(" global transaction isolation level repeatable "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("read")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);