(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{578:function(s,a,t){"use strict";t.r(a);var e=t(33),r=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("blockquote",[t("p",[s._v("MySQL默认不能实时查看执行的SQL语句，因为这会消耗一定的资源。")])]),s._v(" "),t("blockquote",[t("p",[s._v("要开启这个功能，稍微配置一下，打开这个LOG记录就可以了。")])]),s._v(" "),t("h2",{attrs:{id:"查看log功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看log功能"}},[s._v("#")]),s._v(" 查看LOG功能")]),s._v(" "),t("blockquote",[t("p",[s._v("首先，查看是否已经开启实时SQL语句记录。")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SHOW VARIABLES LIKE "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"general_log%"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n+------------------+------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Variable_name    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" Value                              "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------------------+------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" general_log      "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" OFF                                "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" general_log_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" /usr/local/var/mysql/localhost.log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("\n+------------------+------------------------------------+\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" rows "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sec"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("如上"),t("strong",[s._v("general_log")]),s._v("值为OFF说明没有开启：")]),s._v(" "),t("h2",{attrs:{id:"打开log功能"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#打开log功能"}},[s._v("#")]),s._v(" 打开LOG功能")]),s._v(" "),t("h3",{attrs:{id:"临时开启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#临时开启"}},[s._v("#")]),s._v(" 临时开启")]),s._v(" "),t("p",[s._v("如下，打开实时记录SQL语句功能，并指定自定义的log路径：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("mysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SET GLOBAL general_log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'ON'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nmysql"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" SET GLOBAL general_log_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/var/log/mysql/general_log.log'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("这两个命令在MySQL重启后失效，为临时方法。")])]),s._v(" "),t("p",[s._v("说明：这个文件会随着访问的增加而不断变大，所以生产环境建议临时开启，用完及时关闭。")]),s._v(" "),t("h3",{attrs:{id:"永久开启"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#永久开启"}},[s._v("#")]),s._v(" 永久开启")]),s._v(" "),t("p",[s._v("永久有效需要配置"),t("strong",[s._v("my.cnf")]),s._v("文件，加入下面两行：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("general_log "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\ngeneral_log_file "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /var/log/mysql/general_sql.log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("重启MySQL生效。")])]),s._v(" "),t("h3",{attrs:{id:"实时查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#实时查看"}},[s._v("#")]),s._v(" 实时查看")]),s._v(" "),t("p",[s._v("过一小段时间后，就可以导出查看/var/lib/mysql/sql_statement.log文件了，里面记录了所有执行的SQL语句。")]),s._v(" "),t("p",[s._v("如果要实时查看该文件的改动，在Linux系统用tail命令：")]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tail")]),s._v(" -f /var/lib/mysql/general_sql.log\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("另外，也可以用BareTail软件实时查看。")])])}),[],!1,null,null,null);a.default=r.exports}}]);